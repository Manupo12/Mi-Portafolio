---
// ARCHIVO: src/components/Header.astro
// FECHA: 5 de septiembre de 2025
// DESCRIPCIÓN: Versión final del header con los enlaces de navegación actualizados y reordenados.

import { Menu, X } from 'lucide-react';
// Explicación (español):
// - Este componente renderiza el header fijo en la parte superior de la página.
// - Contiene: el nombre del autor (enlace a #inicio), un nav principal para pantallas
//   grandes y un botón que despliega el menú móvil en pantallas pequeñas.
// - El script al final controla dos comportamientos:
//   1) Toggle del menú móvil (mostrar/ocultar y cambiar los iconos Menu/X).
//   2) Ocultar el header al hacer scroll hacia abajo y mostrarlo al hacer scroll hacia arriba
//      (solo si el menú móvil está cerrado), mejorando la experiencia de lectura.
---
<header id="header" class="fixed top-0 left-0 w-full z-50">
    <div class="max-w-4xl mx-auto px-6 py-4">
        <div class="flex items-center justify-between bg-gray-900/70 backdrop-blur-md rounded-full px-4 md:px-6 py-3 border border-gray-700/50 shadow-lg">
            
            <a href="#inicio" class="text-xl font-bold text-white hover:text-emerald-400 transition-colors">
                Manuel Villanueva
            </a>

            <nav class="hidden md:flex items-center space-x-6 text-sm">
                <a href="#sobre-mi" class="text-gray-300 hover:text-emerald-400 transition-colors">Sobre Mí</a>
                <a href="#proyectos" class="text-gray-300 hover:text-emerald-400 transition-colors">Proyectos</a>
                <a href="#certificaciones" class="text-gray-300 hover:text-emerald-400 transition-colors">Certificaciones</a>
                <a href="#demos" class="text-gray-300 hover:text-emerald-400 transition-colors">Demos</a>
                <a href="#contacto" class="text-gray-300 hover:text-emerald-400 transition-colors">Contacto</a>
            </nav>

            <div class="md:hidden">
                <button id="menu-toggle" class="text-white p-2 rounded-md hover:bg-white/10 transition">
                    <Menu id="icon-menu" size={24} />
                    <X id="icon-x" size={24} className="hidden" />
                </button>
            </div>
        </div>
    </div>
    <div id="mobile-menu" class="hidden md:hidden max-w-4xl mx-auto px-6">
        <div class="bg-gray-900/90 backdrop-blur-md rounded-2xl border border-gray-700/50 shadow-xl overflow-hidden">
            <nav class="flex flex-col items-center space-y-4 py-6 text-base">
                <a href="#sobre-mi" class="mobile-link text-gray-300 hover:text-emerald-400 transition-colors">Sobre Mí</a>
                <a href="#proyectos" class="mobile-link text-gray-300 hover:text-emerald-400 transition-colors">Proyectos</a>
                <a href="#certificaciones" class="mobile-link text-gray-300 hover:text-emerald-400 transition-colors">Certificaciones</a>
                <a href="#demos" class="mobile-link text-gray-300 hover:text-emerald-400 transition-colors">Demos</a>
                <a href="#contacto" class="mobile-link text-gray-300 hover:text-emerald-400 transition-colors">Contacto</a>
            </nav>
        </div>
    </div>
</header>

<script>
    // Script para controlar el menú móvil
    // - Selecciona elementos relevantes: toggle button, contenedor del menú y los iconos
    const menuToggle = document.getElementById('menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    const iconMenu = document.getElementById('icon-menu');
    const iconX = document.getElementById('icon-x');
    const mobileLinks = document.querySelectorAll('.mobile-link');

    // Comprobamos que existen los elementos antes de añadir listeners
    if (menuToggle && mobileMenu && iconMenu && iconX) {
        // Toggle: mostrar/ocultar menú móvil y alternar iconos Menu/X
        menuToggle.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
            iconMenu.classList.toggle('hidden');
            iconX.classList.toggle('hidden');
        });

        // Cuando se hace click en un link móvil, cerramos el menú y restauramos el icono Menu
        mobileLinks.forEach(link => {
            link.addEventListener('click', () => {
                mobileMenu.classList.add('hidden');
                iconMenu.classList.remove('hidden');
                iconX.classList.add('hidden');
            });
        });
    }

    // Script para ocultar/mostrar el header al hacer scroll
    // - Oculta el header si el usuario hace scroll hacia abajo y supera 50px.
    // - Muestra el header si el usuario hace scroll hacia arriba.
    // - No oculta el header si el menú móvil está abierto (para no interferir con la navegación).
    const header = document.getElementById('header');
    if (header) {
        let lastScrollY = window.scrollY;
        // Suavizamos la transición de transform y opacity
        header.style.transition = 'transform 0.3s ease-out, opacity 0.3s ease-out';
        
        window.addEventListener('scroll', () => {
            if (
                window.scrollY > 50 &&
                window.scrollY > lastScrollY &&
                mobileMenu &&
                mobileMenu.classList.contains('hidden')
            ) {
                // Scroll hacia abajo: ocultar header
                header.style.transform = 'translateY(-100%)';
                header.style.opacity = '0';
            } else {
                // Scroll hacia arriba o cerca del top: mostrar header
                header.style.transform = 'translateY(0)';
                header.style.opacity = '1';
            }
            lastScrollY = window.scrollY;
        });
    }
</script>